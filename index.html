<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrintZone</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

</head>

<body style="
             
background-image: url('https://images.unsplash.com/photo-1637775297458-7443ffd545b2?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1yZWxhdGVkfDEwfHx8ZW58MHx8fHw%3D&w=1000&q=80'); 
             
background-repeat: no-repeat;
background-attachment: fixed;
background-size: cover;
">
    <div id="container">
        <h1 style="font-size: 21px; color: #fff; font-weight: 900;">&bull; Print Zone &bull;</h1>
        <div class="underline">
        </div>

        <form action="" id="contact_form" autocomplete="off">
            <input type="file" id="actual-btn" accept=".pdf" hidden />

            <!-- our custom upload button -->
            <label for="actual-btn">Choose File</label>

            <!-- name of file chosen -->
            <span id="file-chosen"
                style="color: #fff;font-weight: 500;font-size: 12px;height: 20px;line-height: 20px;  "></span>
            <br>
            <br>

            <div class="telephone2">
                <input type="number" placeholder="Betlarining Soni..." name="telephone" id="telephone_input"
                    onchange="hisoblash" autocomplete="on" onclick="hisoblash">

            </div>

            <div class="subject">

                <select name="subject" id="subject_input" class="qogoz">

                    <option value="1">A5 - oq qora</option>
                    <option value="2">A4 - oq qora</option>
                    <option value="3">A5 - rangli</option>
                    <option value="4">A4 - rangli</option>
                </select>
            </div>
            <div class="subject">
                <select name="subject" id="subject_input" class="jild">
                    <option value="1">Oddiy Pereplyot</option>
                    <option value="2">Temir Pereplyot</option>
                    <option value="3">Kley (Termokley)</option>
                    <option value="4">Qattiq muqova</option>

                </select>
            </div>


            <p style="color: #fff; font-weight: 600;"> - A5 kitobcha </p>

            <p style="color: #fff; font-weight: 600;"> - A4 katta </p>

            <br>
            <br>

            <h1 style="font-size: 14px; color: #fff; font-weight: 600;">Narx:</h1>
            <h1 id="narx" style="font-size: 14px; color:  #fff;font-weight: 600">
                0 so'm
            </h1>
            <br />


            <hr>


            <br>

            <!-- actual upload which is hidden -->

            <!-- <center>
                <i class="fa fa-telegram" style="font-size:68px;color:#229ED9"></i>
            </center> -->
            <center>
                <!-- <u style="color: #fff"> -->
                <p style="color: #fff;font-weight: 500;font-size: 12px;height: 20px;line-height: 20px;  ">
                    <!--                     koâ€™proq buyurtma uchun </i> <a href="https://t.me/book_press/"
                        style="color: #229ED9; text-decoration: none;"><i class="fa fa-telegram"
                            style="font-size:24px;color:#229ED9"> </i> @book_press</a> <br> -->
                    arzon narxlar - </i> <a href="https://t.me/printfaster/"
                        style="color: #229ED9; text-decoration: none;"><i class="fa fa-telegram"
                            style="font-size:24px;color:#229ED9"> </i> @printfaster</a> <br>

                    batafsil - </i> <a href="https://t.me/printzone/" style="color: #229ED9; text-decoration: none;"><i
                            class="fa fa-telegram" style="font-size:24px;color:#229ED9"> </i> @printzone</a> / <a
                        href="tel:88-301-01-00" style="color: #229ED9; text-decoration: none;"><i class="fa fa-phone"
                            style="font-size:24px;color:#229ED9"></i> 88 301-01-00</a><br>

                </p>

            </center>
        </form>

    </div>
    <center>
        <!-- <u style="color: #fff"> -->
        <p style="color: #fff;font-weight: 500;font-size: 17px;height: 30px;line-height: 30px;  ">
            Boshqa xizmatlar kelishilgan narxlarda
        </p>
        <!-- </u> -->
    </center>

</body>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"
    integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    const form = document.querySelector('form');
    form.addEventListener('change', function () {
        hisoblash()
    });

    var telephone_input = document.getElementById('telephone_input');

    //Attach the event listener to the element
    telephone_input.oninput = (event) => {

        hisoblash()
    };

    function toMoneyStyle(value) {
        return (value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,').split(".")[0].replaceAll(",", " ");
    }
    function hisoblash() {
        console.log("ishladi")
        let kitobBetlarSoni = document.getElementById("telephone_input").value;
        let qogoz = document.querySelector(".qogoz").value;
        let jild = document.querySelector(".jild").value





        if (jild == 1 || jild == 2 || jild == 3) {
            if (kitobBetlarSoni < 300) {
                jild = 10000;
            } else if (kitobBetlarSoni < 600) {
                jild = 18000;
            } else if (kitobBetlarSoni < 900) {
                jild = 27000;
            } else {
                jild = 35000;
            }
        } else if (jild == 4) {




            if (kitobBetlarSoni < 600) {
                jild = 30000;
            } else if (kitobBetlarSoni < 1200) {
                jild = 50000;
            } else {
                jild = 75000;
            }
        }
        let narxH1 = document.getElementById("narx");

        let qogozNarx = 0;

        // if (parseInt(kitobBetlarSoni) > 499) {

        //     switch (parseInt(qogoz)) {
        //         case 1:
        //             qogozNarx = 65;
        //             break;
        //         case 2:

        //             qogozNarx = 120;
        //             break;
        //         case 3:
        //             qogozNarx = 80;
        //             break;
        //         case 4:
        //             qogozNarx = 160;
        //             break;
        //     }



        // } 
        // else if (parseInt(kitobBetlarSoni) > 199) {


        //     switch (parseInt(qogoz)) {
        //         case 1:
        //             qogozNarx = 80;
        //             break;
        //         case 2:

        //             qogozNarx = 160;
        //             break;
        //         case 3:
        //             qogozNarx = 100;
        //             break;
        //         case 4:
        //             qogozNarx = 190;
        //             break;
        //     }


        // }

        // else 
        if (parseInt(kitobBetlarSoni) > 99) {




            switch (parseInt(qogoz)) {
                case 1:
                    qogozNarx = 75;
                    break;
                case 2:

                    qogozNarx = 150;
                    break;
                case 3:
                    qogozNarx = 100;
                    break;
                case 4:
                    qogozNarx = 200;
                    break;
            }

            // switch (parseInt(qogoz)) {
            //     case 1:
            //         qogozNarx = 70;
            //         break;
            //     case 2:
            //         qogozNarx = 140;
            //         break;
            //     case 3:
            //         qogozNarx = 120;
            //         break;
            //     case 4:
            //         qogozNarx = 230;
            //         break;


            // }

        }
        // else if (parseInt(kitobBetlarSoni) > 29) {
        //     switch (parseInt(qogoz)) {
        //         case 1:
        //             qogozNarx = 100;
        //             break;
        //         case 2:
        //             qogozNarx = 200;
        //             break;
        //         case 3:
        //             qogozNarx = 200;
        //             break;
        //         case 4:
        //             qogozNarx = 400;
        //             break;


        //     }
        // }

        else {



            switch (parseInt(qogoz)) {
                case 1:
                    qogozNarx = 100;
                    break;
                case 2:
                    qogozNarx = 200;
                    break;
                case 3:


                    qogozNarx = 150;
                    break;
                case 4:
                    qogozNarx = 300;
                    break;


            }


        }




        if (kitobBetlarSoni != "") {
            if (parseInt(kitobBetlarSoni) < 100) {
                narxH1.innerHTML = `<h1 id="narx" style="font-size: 14px; color: #fff;font-weight: 600" >
                ${kitobBetlarSoni}x${toMoneyStyle(qogozNarx)} = ${toMoneyStyle(parseInt(kitobBetlarSoni * qogozNarx))} so'm (Preplyotsiz)
            </h1>`;
            } else {
                narxH1.innerHTML = `<h1 id="narx" style="font-size: 14px; color: #fff;font-weight: 600" >
                ${kitobBetlarSoni}x${toMoneyStyle(qogozNarx)}+${toMoneyStyle(Math.floor((kitobBetlarSoni - 1) / 100) * 1000 + parseInt(jild))}= ${toMoneyStyle(parseInt(kitobBetlarSoni * qogozNarx + Math.floor((kitobBetlarSoni - 1) / 100) * 1000 + parseInt(jild)))} so'm
            </h1>`;
            }

        }

        else {
            narxH1.innerHTML = ` <h1 id="narx" style="font-size: 14px; color:#fff;font-weight: 600 ">
                0 so'm
            </h1>`;
        }

    }

    function readFile(file) {
        return new Promise((resolve, reject) => {
            // Create file reader
            let reader = new FileReader()

            // Register event listeners
            reader.addEventListener("loadend", e => resolve(e.target.result))
            reader.addEventListener("error", reject)

            // Read file
            reader.readAsArrayBuffer(file)
        })
    }

    const actualBtn = document.getElementById('actual-btn');

    const fileChosen = document.getElementById('file-chosen');

    actualBtn.onchange = async (event) => {
        // let pdfjs =  import('pdfjs-dist/build/pdf');
        // let pdfjsWorker =  import('pdfjs-dist/build/pdf.worker.entry');

        // pdfjs.GlobalWorkerOptions.workerSrc = pdfjsWorker;

        var file = event.target.files[0]

        // application/pdf
        console.log(file)
        console.log("++++++++===")
        console.log(file.type)
        if (file.type == "application/pdf") {
            fileChosen.textContent = file.name

            var reader = new FileReader();
            // reader.readAsBinaryString(this.files[0]);
            reader.onloadend = async () => {
                // console.log(">>>> 1")
                // console.log(this.result)
                var typeArray = new Uint8Array(await readFile(file))

                const task = pdfjsLib.getDocument(typeArray)
                // console.log(">>>> 2")
                // console.log(typeArray)
                // console.log(task.promise)

                task.promise.then((pdf) => {
                    // console.log(pdf.numPages)
                    document.getElementById('telephone_input').value = pdf.numPages
                    hisoblash()
                })


            }
            await reader.readAsBinaryString(file)
        } else {
            fileChosen.textContent = "Pdf file yuklang"
            document.getElementById('telephone_input').value = ""
        }


    };




</script>

</html>