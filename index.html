<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrintZone</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

</head>
<style>
    ::placeholder {
        color: black;
        opacity: 1;
        /* Firefox */
    }
</style>

<body style="
background-image: url('https://t4.ftcdn.net/jpg/02/41/67/49/360_F_241674902_1i8NSWE483IGlRkPPvRWWZuLTFBnqIWh.jpg');   
background-repeat: no-repeat;
background-attachment: fixed;
background-size: cover;">
    <div id="container">
        <center><img src="./logo.png" alt="PrinZone" style="width: 100%;margin:-3px auto;"></center>
        <!-- <h1 style="font-size: 21px;  font-weight: 900;color: black;">&bull; Print Zone &bull;</h1>
        <div class="underline" style="color: black;">
        </div> -->

        <form action="" id="contact_form" autocomplete="off">
            <input type="file" id="actual-btn" accept=".pdf" hidden />

            <!-- our custom upload button -->
            <label for="actual-btn" style="background-color: black">Choose File</label>

            <!-- name of file chosen -->
            <span id="file-chosen"
                style="font-weight: 500;font-size: 18px;height: 20px;line-height: 20px; color: black  "></span>
            <br>
            <br>

            <div class="telephone2">
                <input type="number" placeholder="Betlarining Soni..." name="telephone" id="telephone_input"
                    style="color:black" onchange="hisoblash" autocomplete="on" onclick="hisoblash">

            </div>

            <div class="subject">

                <select name="subject" id="subject_input" class="qogoz" style="color:black">

                    <option value="1">A5 ( kichik ) o'lcham</option>
                    <option value="2">A4 ( katta ) o'lcham</option>
                  
                </select>
            </div>
            <div class="subject">
                <select name="subject" id="subject_input" class="jild" style="color:black">
                    <option value="1">Yumshoq muqova</option>
                    <option value="2">Qattiq muqova</option>
                  

                </select>
            </div>
           <div class="telephone2"> 
            <input type="number" placeholder="Nusxa Soni..." name="nusxa" id="telephone_input" class="nusxa_input"
                style="color:black" onchange="hisoblash" autocomplete="on" onclick="hisoblash">

        </div>
            <center>
                <button id="button_hisoblash" action=""
                    style="background-color: black; color:white; border-radius:8px; padding:8px 22px; font-weight: 800; font-size:20px;border:none;cursor:pointer;">Hisoblash</button>
            </center>
            <!-- <p style=" font-weight: 600; color:black"> - A5 kitobcha </p>

            <p style="font-weight: 600; color:black"> - A4 katta </p>

            <br> -->
            <br>

            <h1 style="font-size: 14px; font-weight: 600;color:black">Narx:</h1>
            <h1 id="narx" style="font-size: 14px;font-weight: 600 ; color:black">
                0 so'm
            </h1>
            <br />

            <p style="font-weight: 600;font-size: 14px;height: 30px;line-height: 30px; color:black ">
                * 20+ nusxadan optom narxlar amalda âœ…
            </p>
            <p style="font-weight: 600;font-size: 14px;height: 30px;line-height: 30px; color:black ">
                * Yirik buyurtmalar uchun alohida chegirmalar
            </p>
            <br>
            <p style="font-weight: 600;font-size: 14px;height: 30px;line-height: 30px; color:black ">
                * dostavka bepul
            </p>
          

            <br /><br />
            <hr color="black">


            <br>



           

                <p style="font-weight: 500;font-size: 20px;height: 20px;line-height: 20px; color:black ">
                

                    batafsil :
                    <br>
                   <div style="padding-left :20px;">
                    <a href="https://t.me/printzone2/" style="color:  black; text-decoration: none;"><i
                        class="fa fa-telegram" style="font-size:18px;color:#24A1DE ">  </i> @printzone2</a>
                   </div>
                <br>
                <div style="padding-left :20px;">
                    <a href="Tel: +998917779200" style="color:  black; text-decoration: none;"><i
                            class="fa fa-phone" style="font-size:18px;color: rgb(56, 195, 56)">  </i> 91 777 92 00</a>


                        </p>
                    </div>
                    <br>

                    <!-- <u style="color: #fff"> -->
               

               <br>

                <!-- <u style="color: #fff"> -->
             


             

        
        </form>

    </div>


</body>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"
    integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    const form = document.querySelector('form');

    document.getElementById('button_hisoblash').addEventListener('click', function(e) {
        e.preventDefault();
       hisoblash();
    });
    form.addEventListener('change', function () {
        hisoblash()
    });

    var telephone_input = document.getElementById('telephone_input');

    //Attach the event listener to the element
    telephone_input.oninput = (event) => {

        hisoblash()
    };


    var nusxa_input = document.querySelector('.nusxa_input');

    //Attach the event listener to the element
    nusxa_input.oninput = (event) => {

        hisoblash()
    };

    function toMoneyStyle(value) {
        return (value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,').split(".")[0].replaceAll(",", " ");
    }
    function hisoblash(e) {

        console.log("ishladi")
        let kitobBetlarSoni = document.getElementById("telephone_input").value;


        let nusxaSoni = document.querySelector(".nusxa_input").value;
        if(!nusxaSoni){
           nusxaSoni=1;
        }

        let qogoz = document.querySelector(".qogoz").value;
        let jild = document.querySelector(".jild").value
        let jildValue=document.querySelector(".jild").value


        let total = 0;
        
       

        switch (jild) {
            case "2":
                jild = 25000;
                break;
            case "1":

                jild = 5500;
                break;

        }

       


       //   jild = jild * (Math.floor((kitobBetlarSoni - 1) / 220) + 1);
 
        let narxH1 = document.getElementById("narx");

        let qogozNarx = 0;




        switch (parseInt(jildValue)) {
            case 1:
            switch (parseInt(qogoz)) {
                case 1:
                    qogozNarx = 57;
                    break;
                case 2:
    
                    qogozNarx = 110;
                    break;
            }
                break;
            case 2:

               

                switch (parseInt(qogoz)) {
                    case 1:
                        qogozNarx = 70;
                        break;
                    case 2:

                        qogozNarx = 120;
                        break;
                }
                break;
        }


       



     
       


        let kitobPrice = parseInt(kitobBetlarSoni * qogozNarx + jild);

        if(parseInt(nusxaSoni) ==1){
            kitobPrice =kitobPrice  * 3;
        }

        else if (parseInt(nusxaSoni) <= 10) {
            kitobPrice =kitobPrice  * 2;
        }
        else if (parseInt(nusxaSoni) <= 20) {
            kitobPrice =kitobPrice  * 1.3;
        }
      
        total = kitobPrice * nusxaSoni;

        




        if (kitobBetlarSoni != "" && nusxaSoni !="") {
            narxH1.innerHTML = `<h1 id="narx" style="font-size: 14px; font-weight: 600" >
                ${nusxaSoni} x ${toMoneyStyle(kitobPrice * 1.2)}= ${toMoneyStyle(total* 1.2)} so'm 
            </h1> 


           `;

        }

        else {
            narxH1.innerHTML = ` <h1 id="narx" style="font-size: 14px; font-weight: 600 ">
                0 so'm
            </h1>`;
        }

    }

    function readFile(file) {
        return new Promise((resolve, reject) => {
            // Create file reader
            let reader = new FileReader()

            // Register event listeners
            reader.addEventListener("loadend", e => resolve(e.target.result))
            reader.addEventListener("error", reject)

            // Read file
            reader.readAsArrayBuffer(file)
        })
    }

    const actualBtn = document.getElementById('actual-btn');

    const fileChosen = document.getElementById('file-chosen');

    actualBtn.onchange = async (event) => {
        // let pdfjs =  import('pdfjs-dist/build/pdf');
        // let pdfjsWorker =  import('pdfjs-dist/build/pdf.worker.entry');

        // pdfjs.GlobalWorkerOptions.workerSrc = pdfjsWorker;

        var file = event.target.files[0]

        // application/pdf
        console.log(file)

        console.log(file.type)
        if (file.type == "application/pdf") {
            fileChosen.textContent = file.name

            var reader = new FileReader();
            // reader.readAsBinaryString(this.files[0]);
            reader.onloadend = async () => {
                // console.log(">>>> 1")
                // console.log(this.result)
                var typeArray = new Uint8Array(await readFile(file))

                const task = pdfjsLib.getDocument(typeArray)
                // console.log(">>>> 2")
                // console.log(typeArray)
                // console.log(task.promise)

                task.promise.then((pdf) => {
                    // console.log(pdf.numPages)
                    document.getElementById('telephone_input').value = pdf.numPages
                    hisoblash()
                })


            }
            await reader.readAsBinaryString(file)
        } else {
            fileChosen.textContent = "Pdf file yuklang"
            document.getElementById('telephone_input').value = ""
        }


    };




</script>

</html>