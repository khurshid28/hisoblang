<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrintZone</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

</head>
<style>
    ::placeholder {
        color: black;
        opacity: 1;
        /* Firefox */
    }
</style>

<body style="
background-image: url('https://t4.ftcdn.net/jpg/01/34/21/31/360_F_134213180_vgs3IB9fq6f41PVKDSZYHnFRQEuIVjqG.jpg');   
background-repeat: no-repeat;
background-attachment: fixed;
background-size: cover;">
    <div id="container">
        <h1 style="font-size: 21px;  font-weight: 900;color: black;">&bull; Print Zone &bull;</h1>
        <div class="underline" style="color: black;">
        </div>

        <form action="" id="contact_form" autocomplete="off">
            <input type="file" id="actual-btn" accept=".pdf" hidden />

            <!-- our custom upload button -->
            <label for="actual-btn" style="background-color: black">Choose File</label>

            <!-- name of file chosen -->
            <span id="file-chosen"
                style="font-weight: 500;font-size: 18px;height: 20px;line-height: 20px; color: black  "></span>
            <br>
            <br>

            <div class="telephone2">
                <input type="number" placeholder="Betlarining Soni..." name="telephone" id="telephone_input"
                    style="color:black" onchange="hisoblash" autocomplete="on" onclick="hisoblash">

            </div>

            <div class="subject">

                <select name="subject" id="subject_input" class="qogoz" style="color:black">

                    <option value="1">A5 qog'oz</option>
                    <option value="2">A4 qog'oz</option>
                  
                </select>
            </div>
            <div class="subject">
                <select name="subject" id="subject_input" class="jild" style="color:black">
                    <option value="1">Qattiq muqova</option>
                    <option value="2">Yumshoq muqova</option>

                </select>
            </div>

            <center>
                <button id="button_hisoblash" action=""
                    style="background-color: black; color:white; border-radius:8px; padding:8px 22px; font-weight: 800; font-size:20px;border:none;cursor:pointer;">Hisoblash</button>
            </center>
            <p style=" font-weight: 600; color:black"> - A5 kitobcha </p>

            <p style="font-weight: 600; color:black"> - A4 katta </p>

            <br>
            <br>

            <h1 style="font-size: 14px; font-weight: 600;color:black">Narx:</h1>
            <h1 id="narx" style="font-size: 14px;font-weight: 600 ; color:black">
                0 so'm
            </h1>
            <br />


            <hr color="black">


            <br>



            <center>

                <p style="font-weight: 500;font-size: 20px;height: 20px;line-height: 20px; color:black ">
                    <!--                     koâ€™proq buyurtma uchun </i> <a href="https://t.me/book_press/"
                        style="color: #229ED9; text-decoration: none;"><i class="fa fa-telegram"
                            style="font-size:24px;color:#229ED9"> </i> @book_press</a> <br> -->

                    batafsil - </i> <a href="https://t.me/Printzone2/" style="color:  black; text-decoration: none;"><i
                            class="fa fa-telegram" style="font-size:18px;color: black"> </i> @Printzone2</a>
                    <br>

                    <!-- <u style="color: #fff"> -->
                <p style="font-weight: 500;font-size: 17px;height: 30px;line-height: 30px; color:black ">
                    # Qattiq muqovali kitob tayyor bo'lish vaqti 5-12 kun

                </p>



                <!-- <u style="color: #fff"> -->
                <p style="font-weight: 500;font-size: 17px;height: 30px;line-height: 30px; color:black ">
                    # Saytdagi eng arzon narxlar faqat 20+ buyurtmalar uchun amal qiladi
                    
                </p>
                <p style="font-weight: 500;font-size: 17px;height: 30px;line-height: 30px; color:black ">
                    # Oq-qora va rangli kitoblar bir xil narxlarda
                </p>


                </p>

            </center>
        </form>

    </div>


</body>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"
    integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    const form = document.querySelector('form');

    document.getElementById('button_hisoblash').addEventListener('click', function(e) {
        e.preventDefault();
       hisoblash();
    });
    form.addEventListener('change', function () {
        hisoblash()
    });

    var telephone_input = document.getElementById('telephone_input');

    //Attach the event listener to the element
    telephone_input.oninput = (event) => {

        hisoblash()
    };

    function toMoneyStyle(value) {
        return (value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,').split(".")[0].replaceAll(",", " ");
    }
    function hisoblash(e) {

        console.log("ishladi")
        let kitobBetlarSoni = document.getElementById("telephone_input").value;
        let qogoz = document.querySelector(".qogoz").value;
        let jild = document.querySelector(".jild").value
        let jildValue=document.querySelector(".jild").value
        
       

        switch (jild) {
            case "1":
                jild = 25000;
                break;
            case "2":

                jild = 5500;
                break;

        }

       


       //   jild = jild * (Math.floor((kitobBetlarSoni - 1) / 220) + 1);
 
        let narxH1 = document.getElementById("narx");

        let qogozNarx = 0;




        switch (parseInt(jildValue)) {
            case 1:
                switch (parseInt(qogoz)) {
                    case 1:
                        qogozNarx = 70;
                        break;
                    case 2:

                        qogozNarx = 120;
                        break;
                }
                break;
            case 2:

                switch (parseInt(qogoz)) {
                    case 1:
                        qogozNarx = 57;
                        break;
                    case 2:
        
                        qogozNarx = 110;
                        break;
                }
                break;
        }


       









        if(parseInt(kitobBetlarSoni) ==1){
            qogozNarx = qogozNarx * 3;
        }

        else if (parseInt(kitobBetlarSoni) <= 10) {
            qogozNarx = qogozNarx * 2;
        }
        else if (parseInt(kitobBetlarSoni) <= 20) {
            qogozNarx = qogozNarx*1.3;
        }
      


        




        if (kitobBetlarSoni != "") {
            narxH1.innerHTML = `<h1 id="narx" style="font-size: 14px; font-weight: 600" >
                ${kitobBetlarSoni}x${toMoneyStyle(qogozNarx)}+${toMoneyStyle(parseInt(jild))}= ${toMoneyStyle(parseInt(kitobBetlarSoni * qogozNarx + jild))} so'm
            </h1>`;

        }

        else {
            narxH1.innerHTML = ` <h1 id="narx" style="font-size: 14px; font-weight: 600 ">
                0 so'm
            </h1>`;
        }

    }

    function readFile(file) {
        return new Promise((resolve, reject) => {
            // Create file reader
            let reader = new FileReader()

            // Register event listeners
            reader.addEventListener("loadend", e => resolve(e.target.result))
            reader.addEventListener("error", reject)

            // Read file
            reader.readAsArrayBuffer(file)
        })
    }

    const actualBtn = document.getElementById('actual-btn');

    const fileChosen = document.getElementById('file-chosen');

    actualBtn.onchange = async (event) => {
        // let pdfjs =  import('pdfjs-dist/build/pdf');
        // let pdfjsWorker =  import('pdfjs-dist/build/pdf.worker.entry');

        // pdfjs.GlobalWorkerOptions.workerSrc = pdfjsWorker;

        var file = event.target.files[0]

        // application/pdf
        console.log(file)

        console.log(file.type)
        if (file.type == "application/pdf") {
            fileChosen.textContent = file.name

            var reader = new FileReader();
            // reader.readAsBinaryString(this.files[0]);
            reader.onloadend = async () => {
                // console.log(">>>> 1")
                // console.log(this.result)
                var typeArray = new Uint8Array(await readFile(file))

                const task = pdfjsLib.getDocument(typeArray)
                // console.log(">>>> 2")
                // console.log(typeArray)
                // console.log(task.promise)

                task.promise.then((pdf) => {
                    // console.log(pdf.numPages)
                    document.getElementById('telephone_input').value = pdf.numPages
                    hisoblash()
                })


            }
            await reader.readAsBinaryString(file)
        } else {
            fileChosen.textContent = "Pdf file yuklang"
            document.getElementById('telephone_input').value = ""
        }


    };




</script>

</html>